<div class="p-4 md:p-6 bg-white dark:bg-slate-900 min-h-full rounded-lg shadow-md">
  <div class="flex flex-col items-center gap-6 mx-auto bg-white p-6 rounded-2xl shadow w-full border border-gray-200">

    <!-- Tipo de cliente -->
    <p-select
      [options]="clientTypeOptions"
      [(ngModel)]="clientType"
      placeholder="Selecione o tipo"
      (ngModelChange)="onClientTypeChange()"
      optionLabel="label"
      optionValue="value"
      class="w-full sm:w-2/3 md:w-1/3"
    />

    <!-- CPF/CNPJ -->
    @if(clientType === 'PF'){
      <input
        type="text"
        pInputText
        placeholder="CPF do Cliente"
        [(ngModel)]="cpfCnpj"
        mask="000.000.000-00"
        unmask="true"
        maxlength="14"
        [disabled]="!clientType"
        class="w-full sm:w-2/3 py-3 px-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 transition"
      />
    } @if(clientType === 'PJ'){
      <input
        type="text"
        pInputText
        placeholder="CNPJ do Cliente"
        [(ngModel)]="cpfCnpj"
        mask="00.000.000/0000-00"
        unmask="true"
        maxlength="18"
        [disabled]="!clientType"
        class="w-full sm:w-2/3 py-3 px-4 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400 transition"
      />
    }

    <!-- Botão de consulta -->
    <div class="w-full sm:w-2/3 flex justify-center">
      <p-button
        icon="pi pi-search"
        (onClick)="consultClient()"
        label="Consultar Cliente"
        severity="info"
        [disabled]="!cpfCnpj || !clientType"
        class="w-full sm:w-auto"
      />
    </div>

    <!-- Loading -->
    @if(isLoading){
      <div class="flex justify-center w-full py-4">
        <p-progress-spinner ariaLabel="isLoading" />
      </div>
    } @else {

    <!-- Resultados -->
    <div class="flex flex-col gap-4 mt-6 w-full">
      <div
        *ngFor="let client of dataClient; let i = index"
        class="flex flex-col md:flex-row items-start md:items-center gap-4 md:gap-6 p-5 bg-white border border-gray-200 rounded-xl shadow-sm hover:shadow-lg transition-all duration-300 w-full"
      >
        <!-- Nome -->
        <div class="flex flex-col min-w-0 w-full md:w-[220px]">
          <span class="text-[11px] text-gray-400 uppercase tracking-wider mb-1">Nome</span>
          <span class="font-semibold text-gray-800 truncate">
            {{ clientType === "PJ" ? client.companyName : client.name }}
          </span>
        </div>

        <!-- Código do plano -->
        <div class="flex flex-col min-w-0 w-full md:w-[160px] text-center">
          <span class="text-[11px] text-gray-400 uppercase tracking-wider mb-1">Código do plano</span>
          <span class="text-gray-700 font-medium truncate">
            {{ client.contracts[0]?.planCode || " - " }}
          </span>
        </div>

        <!-- Endereço -->
        <div class="flex flex-col min-w-0 w-full md:w-[320px]">
          <span class="text-[11px] text-gray-400 uppercase tracking-wider mb-1">Endereço</span>
          <span class="text-gray-600 font-medium truncate">
            {{ client.addresses[0]?.street }},
            {{ client.addresses[0]?.number }},
            {{ client.addresses[0]?.neighborhood }},
            {{ client.addresses[0]?.city }}
          </span>
        </div>

        <!-- Telefone -->
        <div class="flex flex-col min-w-0 w-full md:w-[160px]">
          <span class="text-[11px] text-gray-400 uppercase tracking-wider mb-1">Telefone</span>
          <span class="text-gray-700 font-medium truncate">
            {{
              clientType === "PJ"
                ? client.mobilePhone
                : (client.phone | phones)
            }}
          </span>
        </div>

        <!-- Botão -->
        <div class="flex flex-row gap-2 justify-center md:justify-end w-full md:w-auto mt-4 md:mt-0">
       
            <p-button
              icon="pi pi-eye"
              severity="info"
              [rounded]="true"
              class="px-4"
              label="Visualizar"
              (onClick)="viewClient(client)"
            ></p-button>
        </div>
      </div>
    </div>
    }
  </div>
</div>
